<Window x:Class="StartupMaster.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ui="http://schemas.modernwpf.com/2019"
        xmlns:converters="clr-namespace:StartupMaster.Converters"
        ui:WindowHelper.UseModernWindowStyle="True"
        Title="Startup Master v2.0"
        Width="1200" Height="700"
        MinWidth="800" MinHeight="500"
        Background="{DynamicResource SystemControlPageBackgroundChromeLowBrush}"
        StateChanged="Window_StateChanged">

    <Window.Resources>
        <converters:BoolToVisibilityConverter x:Key="BoolToVis"/>
        <converters:InverseBoolToVisibilityConverter x:Key="InverseBoolToVis"/>

        <Style x:Key="ToolbarButton" TargetType="Button" BasedOn="{StaticResource DefaultButtonStyle}">
            <Setter Property="Height" Value="34"/>
            <Setter Property="Padding" Value="14,0"/>
            <Setter Property="Margin" Value="0,0,6,0"/>
            <Setter Property="FontSize" Value="13"/>
        </Style>

        <Style x:Key="ActionButton" TargetType="Button" BasedOn="{StaticResource DefaultButtonStyle}">
            <Setter Property="Height" Value="26"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Padding" Value="8,0"/>
            <Setter Property="Margin" Value="2,0"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header Banner -->
        <Border Grid.Row="0" Background="#1a1a2e" Padding="15,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="&#xE7F8;" FontFamily="Segoe MDL2 Assets" FontSize="22"
                               Foreground="#00aaff" VerticalAlignment="Center" Margin="0,0,10,0"/>
                    <TextBlock Text="Startup Master" FontSize="18" FontWeight="Bold"
                               Foreground="White" VerticalAlignment="Center"/>
                    <TextBlock Text="v2.0" FontSize="11" Foreground="#888"
                               VerticalAlignment="Center" Margin="8,3,0,0"/>
                </StackPanel>
                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <Button Content="&#xE9F5;  Statistics" FontFamily="Segoe UI" Height="30"
                            Padding="10,0" Margin="0,0,6,0" Click="StatisticsButton_Click"
                            FontSize="12"/>
                    <Button Content="&#xE71D;  Batch" FontFamily="Segoe UI" Height="30"
                            Padding="10,0" Margin="0,0,6,0" Click="BatchButton_Click"
                            FontSize="12"/>
                    <Button Content="&#xE8AB;  Analyze" FontFamily="Segoe UI" Height="30"
                            Padding="10,0" Click="AnalyzeButton_Click"
                            FontSize="12"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Toolbar -->
        <Border Grid.Row="1" Background="#111122" Padding="12,8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <Button Content="&#xE72C;  Refresh" Style="{StaticResource ToolbarButton}" Click="RefreshButton_Click"/>
                    <Button Content="&#xE710;  Add New" Style="{StaticResource ToolbarButton}"
                            Background="#0078d4" Foreground="White" Click="AddButton_Click"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="12,0,0,0">
                    <Button Content="&#xE8B5;  Export" Style="{StaticResource ToolbarButton}" Click="ExportButton_Click"/>
                    <Button Content="&#xE8B6;  Import" Style="{StaticResource ToolbarButton}" Click="ImportButton_Click"/>
                </StackPanel>

                <StackPanel Grid.Column="3" Orientation="Horizontal" Margin="0,0,8,0">
                    <ComboBox x:Name="FilterComboBox" Width="155" Height="34" SelectedIndex="0"
                              SelectionChanged="FilterComboBox_SelectionChanged">
                        <ComboBoxItem Content="All Items"/>
                        <ComboBoxItem Content="Enabled Only"/>
                        <ComboBoxItem Content="Disabled Only"/>
                        <ComboBoxItem Content="Registry"/>
                        <ComboBoxItem Content="Startup Folder"/>
                        <ComboBoxItem Content="Task Scheduler"/>
                        <ComboBoxItem Content="Services"/>
                    </ComboBox>
                </StackPanel>

                <TextBox x:Name="SearchBox" Grid.Column="4" Width="220" Height="34"
                         ui:ControlHelper.PlaceholderText="&#xE721; Search items..."
                         TextChanged="SearchBox_TextChanged"/>
            </Grid>
        </Border>

        <!-- Data Grid -->
        <DataGrid x:Name="StartupItemsGrid" Grid.Row="2" Margin="10,8,10,4"
                  AutoGenerateColumns="False"
                  CanUserAddRows="False"
                  SelectionMode="Single"
                  GridLinesVisibility="Horizontal"
                  HeadersVisibility="Column"
                  RowHeight="38"
                  Background="#0a0a14"
                  Foreground="#e0e0e0"
                  BorderBrush="#333"
                  BorderThickness="1"
                  AlternatingRowBackground="#12121e"
                  ColumnHeaderHeight="36">
            <DataGrid.ColumnHeaderStyle>
                <Style TargetType="DataGridColumnHeader">
                    <Setter Property="Background" Value="#1a1a2e"/>
                    <Setter Property="Foreground" Value="#aaa"/>
                    <Setter Property="FontSize" Value="12"/>
                    <Setter Property="FontWeight" Value="SemiBold"/>
                    <Setter Property="Padding" Value="8,6"/>
                    <Setter Property="BorderBrush" Value="#333"/>
                    <Setter Property="BorderThickness" Value="0,0,1,1"/>
                </Style>
            </DataGrid.ColumnHeaderStyle>
            <DataGrid.RowStyle>
                <Style TargetType="DataGridRow">
                    <Setter Property="Background" Value="#0a0a14"/>
                    <Setter Property="Foreground" Value="#e0e0e0"/>
                    <Setter Property="FontSize" Value="12.5"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding IsDangerous}" Value="True">
                            <Setter Property="Background" Value="#3a1020"/>
                            <Setter Property="Foreground" Value="#ff6080"/>
                            <Setter Property="FontWeight" Value="SemiBold"/>
                        </DataTrigger>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="Background" Value="#1a2a4a"/>
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" Value="#161628"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </DataGrid.RowStyle>
            <DataGrid.CellStyle>
                <Style TargetType="DataGridCell">
                    <Setter Property="Padding" Value="6,4"/>
                    <Setter Property="BorderThickness" Value="0"/>
                    <Setter Property="VerticalAlignment" Value="Center"/>
                    <Style.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="Background" Value="Transparent"/>
                            <Setter Property="Foreground" Value="#e0e0e0"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </DataGrid.CellStyle>
            <DataGrid.Columns>
                <DataGridTextColumn Header="Status" Binding="{Binding StatusDisplay}" Width="90">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="VerticalAlignment" Value="Center"/>
                            <Setter Property="Padding" Value="6,0"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="200">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="FontWeight" Value="Medium"/>
                            <Setter Property="VerticalAlignment" Value="Center"/>
                            <Setter Property="ToolTip" Value="{Binding DangerReason}"/>
                            <Setter Property="Padding" Value="6,0"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Command" Binding="{Binding Command}" Width="*">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="Foreground" Value="#999"/>
                            <Setter Property="VerticalAlignment" Value="Center"/>
                            <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
                            <Setter Property="ToolTip" Value="{Binding Command}"/>
                            <Setter Property="Padding" Value="6,0"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Location" Binding="{Binding LocationDisplay}" Width="120">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="Foreground" Value="#88aacc"/>
                            <Setter Property="VerticalAlignment" Value="Center"/>
                            <Setter Property="Padding" Value="6,0"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Impact" Binding="{Binding ImpactDisplay}" Width="75">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="Foreground" Value="#ffaa44"/>
                            <Setter Property="VerticalAlignment" Value="Center"/>
                            <Setter Property="Padding" Value="6,0"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTextColumn Header="Publisher" Binding="{Binding Publisher}" Width="140">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="Foreground" Value="#777"/>
                            <Setter Property="VerticalAlignment" Value="Center"/>
                            <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
                            <Setter Property="Padding" Value="6,0"/>
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
                <DataGridTemplateColumn Header="Actions" Width="240">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                                <Button Content="Enable" Style="{StaticResource ActionButton}"
                                        Width="55" Click="EnableButton_Click"
                                        Visibility="{Binding IsEnabled, Converter={StaticResource BoolToVis}}"/>
                                <Button Content="Disable" Style="{StaticResource ActionButton}"
                                        Width="55" Click="DisableButton_Click"
                                        Visibility="{Binding IsEnabled, Converter={StaticResource InverseBoolToVis}}"/>
                                <Button Content="Edit" Style="{StaticResource ActionButton}"
                                        Width="45" Click="EditButton_Click"/>
                                <Button Content="Del" Style="{StaticResource ActionButton}"
                                        Width="40" Click="DeleteButton_Click"
                                        Foreground="#ff6666"/>
                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>

        <!-- Status Bar -->
        <Border Grid.Row="3" Background="#111122" Height="32">
            <Grid Margin="12,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBlock x:Name="StatusText" Grid.Column="0" Text="Ready"
                           VerticalAlignment="Center" Foreground="#888" FontSize="12"/>
                <TextBlock x:Name="ItemCountText" Grid.Column="2" Text="0 items"
                           VerticalAlignment="Center" Foreground="#aaa" FontSize="12"
                           FontWeight="SemiBold"/>
            </Grid>
        </Border>
    </Grid>
</Window>
